<!DOCTYPE html>
<html>
<head>
  <title>Register Student</title>
</head>
<body>

<script src="../core/firebase.js"></script>

<h2>Register Student</h2>

<form id="form">
  <input id="name" placeholder="Student Name" required>
  <select id="gender">
    <option>Male</option>
    <option>Female</option>
  </select>
  <input type="date" id="dob">
  <button>Register</button>
</form>

<script>
auth.onAuthStateChanged(user => {
  db.collection("classes")
    .where("teacherEmail", "==", user.email)
    .get()
    .then(snapshot => {
      const myClass = snapshot.docs[0];

      form.onsubmit = e => {
        e.preventDefault();
        db.collection("students").add({
          name: name.value,
          gender: gender.value,
          dob: dob.value,
          classId: myClass.id,
          teacherEmail: user.email,
          approved: false,
          createdAt: new Date()
        });
        alert("Student registered (pending approval)");
        form.reset();
      };
    });
});
</script>

</body>
</html>
